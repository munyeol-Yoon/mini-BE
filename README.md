# 항해99 2조 미니 프로젝트 이제빵

## 기획

게시판 빵집 리뷰사이트를 기획하였고, 이제용이 좋아하는 빵 일명 이제빵이라는 제목의 사이트를 만들기로 하였습니다.

S.A 링크 : https://www.notion.so/2-SA-346bc5586c9b4efcab9c48ed3e9b2371

## 아키텍쳐

![아키텍쳐](/architecture.png)

## ERD

![ERD](</drawSQL-mini-be-erd-export-2023-07-17%20(1).png>)

## 기술 스택

### FE

![](https://camo.githubusercontent.com/eea3c89b5aa320f391bd9ce962c4ef7d92c943a56c376c6cbac82be641585101/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4a6176615363726970742d4637444631453f7374796c653d666f722d7468652d6261646765266c6f676f3d4a617661536372697074266c6f676f436f6c6f723d626c61636b)![](https://camo.githubusercontent.com/20779f9d605be40d4f84bbc93a5fee22e86068e785a0c0ed8d90d3d15041a3fc/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f52656163742d3631444146423f7374796c653d666f722d7468652d6261646765266c6f676f3d5265616374266c6f676f436f6c6f723d626c61636b)![](https://camo.githubusercontent.com/40ae88f73ae80a91fc3035364417afdb9936bb558c50cbb9fbed2d476d7daa87/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f526561637420526f757465722d4341343234353f7374796c653d666f722d7468652d6261646765266c6f676f3d526561637420526f75746572266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/40a02fbec2410fe98c2dfbe605d4243eaec9d28f187d4db194f028159fb89ec0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4178696f732d3541323945343f7374796c653d666f722d7468652d6261646765266c6f676f3d4178696f73266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/2fae549118710fd8284be62292b9e9a6cdd561cb50d46f35938b08dc3fc2c4e7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f56657263656c2d3030303030303f7374796c653d666f722d7468652d6261646765266c6f676f3d76657263656c266c6f676f436f6c6f723d7768697465)

### BE

![](https://camo.githubusercontent.com/7d7b100e379663ee40a20989e6c61737e6396c1dafc3a7c6d2ada8d4447eb0e4/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6e6f64652e6a732d3644413535463f7374796c653d666f722d7468652d6261646765266c6f676f3d6e6f64652e6a73266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/5f06192d3f3c5bcd392b6936d8c3c40d4c6aad18920bc7abf67c11f5ccfd4942/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f657870726573732d3030303030303f7374796c653d666f722d7468652d6261646765266c6f676f3d65787072657373266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/d8ac4c7a04a98fe1c0c982f18f0522c58e5cdee512e94a57d3d552dad6eb3bd8/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4a534f4e2057656220546f6b656e732d3030303030303f7374796c653d666f722d7468652d6261646765266c6f676f3d4a534f4e2057656220546f6b656e73266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/5d9bcd13fd23ed15ba13c4eb64e76504c351655c3097203bf15860286c5f9aba/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f504d322d3242303337413f7374796c653d666c61742d737175617265266c6f676f3d504d32266c6f676f436f6c6f723d7768697465)

![](https://camo.githubusercontent.com/97ab783ee5c3992b11126cce973670e336acc4e71829dd0ad39aa339a43b771b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f676974687562616374696f6e732d3230383846462e7376673f7374796c653d666f722d7468652d6261646765266c6f676f3d676974687562616374696f6e73266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/cf5c1e40095f0f323b7763d51da79ec685aaf6856d2d1d1c87bae70b6b194b97/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d616d617a6f6e73332d4542303031423f7374796c653d666f722d7468652d6261646765266c6f676f3d616d617a6f6e7333266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/4562c2cf5e2f49554c7c82ece5b905d8982e57951aa3a7966467022733b2d374/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d616d617a6f6e6563322d4646393930303f7374796c653d666f722d7468652d6261646765266c6f676f3d616d617a6f6e656332266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/76cd4c8e806c489ba3947bd2cb881e2e52c76f0a0038bee37d46fee94c6175a1/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d41575320436f64654465706c6f792d3542413734353f7374796c653d666f722d7468652d6261646765266c6f676f3d41575320436f64654465706c6f79266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/933c97f50caaea4aaca1ac2f6bf306446ff6df4291ce0a70965ab0d11acd4385/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d4e67696e782d677265656e3f7374796c653d666f722d7468652d6261646765266c6f676f3d4e67696e78266c6f676f436f6c6f723d7768697465)

![](https://camo.githubusercontent.com/41a19c1f24581c8c317a881a47582c6d73af2b20e0f6b9aab7ec0bb43ddba88b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d616d617a6f6e7264732d3532374646463f7374796c653d666f722d7468652d6261646765266c6f676f3d616d617a6f6e726473266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/124c378aa588501ba68fa7878eb2eec94f2e443f7c6a94c562e66cdc4d617b1b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d6d7973716c2d626c75653f7374796c653d666f722d7468652d6261646765266c6f676f3d4d7973716c266c6f676f436f6c6f723d7768697465)![](https://camo.githubusercontent.com/50c8dacf8a3468b5c4150b154d41c0d5a4c95ab11a2e3a589bb2a86a9e110bc3/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d73657175656c697a652d626c75653f7374796c653d666f722d7468652d6261646765266c6f676f3d53657175656c697a65266c6f676f436f6c6f723d7768697465)

## 🌲 기술적 의사 결정

### FRONT-END

| 사용 기술             | 기술 설명                                                                                                                                                                                      |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Styled-Components** | - CSS in JS라는 접근 방식으로 동적 스타일링이 가능해짐<br>- 재사용 컴포넌트를 만드는데에 유리함<br>- 각 요소에 고유의 클래스 이름 부여로 className으로 인한 스타일 충돌 문제를 효과적으로 방지 |
| **Vercel**            | - Github에 Push를 통해 자동적으로 빌드와 배포 과정이 이루어짐<br>- 배포 과정 최적화와 복잡한 작업의 단순화에 큰 도움이 됨 > 개발 프로세스가 한층 간편해짐                                      |
| **Axios**             | - instance : 코드 가독성, 유지 보수에 큰 장점을 가짐<br>- interceptor : 토큰 처리, 에러 핸들링, 로그 관리 등 다양한 작업 수행에 유용                                                           |

### BACK-END

| 사용 기술      | 기술 설명                                                                                                                                                                                                                                                                                                                                                           |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Multer**     | - 파일 업로드 버퍼 처리 및 물리적 파일 저장 방지 > 메모리 스토리지 타입의 객체 사용을 위함 </br>- 이미지를 저장해야하나 동영상 스트리밍이 필요하지 않을 때 </br>- Formidable, Busboy 등과 비교하였을 때의 Multer </br> - Express와 함께 작동하며 formidable보다 더 세밀한 제어를 가능하게 해줌 </br>- Express의 미들웨어로 작동, 업로드 된 파일 수를 제한할 수 있음 |
| **AWS S3**     | - 이미지 파일을 DB가 아닌 S3에 저장하여 DB 성능 최적화로 DB 저장 부담 완화 </br> - 이미지 파일의 서버 저장을 피하며 디스크 공간을 확보, 최적화 </br> - 이미지 입출력 작업을 S3로 이관, 서버 응답 속도 향상                                                                                                                                                          |
| **Git Action** | - “프로젝트 스코프”에 따른 통합성과 접근성 </br> - 별도 설치/인프라 확장/운영/문서(리소스) 관리 등에 대한 고려 불필요 </br> - GitHub에서 전체 관리 가능 </br> - 설정 정형화 > 접근성▲                                                                                                                                                                               |
| **Nginx**      | - 비동기 방식을 통해 버퍼 오버플로우 예방과 높은 효율성 보장 </br> - 병렬 처리 속도가 빠르고 안정적이라 Apache 대비 높은 성능 제공 </br> - SSL 인증 지원으로 보안성 확보 </br> - 포트 리다이렉션으로 사용자 요청 안전처리 및 정확도가 향상된 결과 제공                                                                                                              |
| **Joi**        | - 라이브러리 내 메서드를 통한 에러메시지 커스터마이징의 용이성 </br> - 여러 필드를 한 번에 검증 가능하여 스키마 검증 상 높은 용이성 </br> - 데이터 변환의 유연성 및 Null 변환 및 허용에 대한 용이성 </br> - 복잡한 데이터 유효성 검사에 효과적                                                                                                                      |
| **Bcrypt**     | - 데이터베이스 유출 시 평문 비밀번호의 계정보안 위협 방지 </br> - 사용자 게시글 무단 수정 방지를 위해 비밀번호 해싱으로 보안 강화 </br> - 비교적 낮은 메모리 사용량에 비해 솔트를 활용한 높은 보안성, 직관적 코드사용으로 높은 접근성                                                                                                                               |

## 🧨 트러블 슈팅

### FRONT-END

<details>
<summary>게시글 업로드 multipart/form-data 형식 처리</summary>
  <br>
  
  **`문제`**
  
  게시글 업로드 과정에서 파일을 보내기 때문에 프론트에서는 formData로 해당데이터를 서버로 전송할 필요가 있었음. custom hooks으로 분리하자, 해당 코드가 바뀌면 모든 코드가 다 formData 형식으로 바뀜.
    
  **`해결`**
  
  custom hooks을 제거하고, 각 컨테이너 컴포넌트마다 onChange 핸들러와 onSubmit 핸들러를 만들어서 각각 상태를 관리하는 코드로 변환함.

</details>
<details>
<summary>redux thunk 사용 문제</summary>
<br>

**`문제`**

redux thunk는 redux의 미들웨어임. 이는 액션을 reducer로 보내기 전에 원하는 작업을 할 수 있는 툴인데, 비동기 통신을 했을 때 그 결과를 전역 상태로 관리할 수 있다는 이점이 있지만 이번 프로젝트에서는 이점을 활용할 필요성이 없었음.
**`해결`**

redux thunk대신 usestate hooks을 통한 지역상태 관리로서 해당 컴포넌트의 상태가 종속될 수 있도록 관리함. 또한, 코드가 길어지고 가독성이 떨어지는 것을 막기 위하여 비동기 통신 지역 상태 관리와 관련된 로직을 custom hooks를 통해 따로 분리.

</details>
<details>
<summary>토큰 저장 문제</summary>

**`문제`**

서버로부터 토큰을 클라이언트가 받아, 해당 토큰을 웹스토리지 또는 쿠키에 저장해야 하는 문제가 있었음.

**`해결`**

쿠키의 경우 보안에 취약하고, 웹스토리지의 공간이 작음. 또한, 매번 서버에게 요청해야 한다는 단점점이 있었음. 반면 웹스토리지, 그 중에서도 로컬 스토리지의 경우 보안에 강하며 웹스토리지 공간도 크고, 매번 서버에 요청을 보내지 않아도 되며, 반영구적으로 데이터가 보존된다는 장점이 있었음. 따라서 토큰을 로컬 스토리지에 저장하기로 함.

</details>

### BACK-END

<details>
<summary>certbot 키 발급 문제</summary>

  <br>
  
  **`문제`**
서버에 SSL 인증서를 설치하려고 Certbot을 사용하여 인증키를 발급하려고 했으나 실패하였음. 인증 키 발급 과정에서 unauthorized 오류와 Invalid response 오류가 발생, 시도를 반복해도 동일한 오류가 재차 발생했음.

**`해결`**
레코드 주소를 여러개 사용하던 DNS 설정을 수정, 레코드 수정 후 ‘certbot”을 재실행하니 SSL 인증서 발급이 정상적으로 실행됨.

</details>
<details>
<summary>브라우저 토큰 스토리지 문제</summary>

<br>

**`문제`**
JWT Access Token 인증 시 “로그인이 필요한 기능입니다.” 에러가 지속적으로 발생함. 에러 로그를 확인, 쿠키값을 가져오지 못 해 쿠키가 브라우저 헤더에는 전달이 되었으나, 스토리지에 담기지 않는 것을 알 수 있었음. 초기에는 CORS 문제로 판단, 백엔드 측 CORS 옵션을 수정했으나 효과 전무. 쿠키 전달 문제로 판단하여 다양한 쿠키 옵션을 사용해 보았으나 여전히 효과가 없었음. 프론트 측에서도 axios를 사용하여 해결해보고자 했으나 오히려 CORS 에러가 발생하였음.

**`해결`**
header로 토큰을 받아 access토큰을 인증 완료함. 대부분의 웹 애플리케이션은 쿠키의 이름을 대소문자 구분 없이 처리함. Header 필드는 대소문자를 구분하지 않는게 일반적인 관행이라는 것을 알게됨. 시간 관계상 더 자세히 알아볼 수 없었지만 시간이 더 있었다면 자세히 알아볼 수 있었을 것으로 생각됨.

</details>
<details>
<summary>AWS : Multer, S3 오류</summary>
<br>

**`문제`**
Multer-S3을 통해 이미지를 핸들링 하던 중 AWS S3에 접근할 수 없다는 에러가 발생함.

**`해결`**
AWS의 액세스 설정을 퍼블릭으로 바꾼 뒤 해결됨.
multer-s3 다운그레이드를 통해 버전을 바꾸는 것을 성공함.

</details>
<details>
<summary>Joi에서 'imgsrc'의 null 값 허용 문제</summary>
<br>

**`문제`**
프로젝트를 진행하면서 사용자가 'imgsrc'필드에 null 값을 제공할 수 있도록 허용해야 하는 요구사항이 있었음. 하지만 초기에 설정한 Joi 스키마는 이를 허용하지 않아, 사용자가 'imgsrc' 필드에 null을 입력하면 유효하지 않은 값으로 처리하는 문제가 발생함.

**`해결`**
수정한 스키마를 적용한 후, 사용자가 'imgsrc' 필드에 null 값을 제공하는 경우에도 Joi가 이를 유효한 값으로 처리하였음. 따라서 사용자가 'imgsrc' 필드에 null 값을 제공하면, 이제 요청이 성공적으로 처리되어, 이전에 발생하던 문제해결.

</details>
<details>
<summary> Joi에서 '공백' 처리 문제</summary>
<br>

**`문제`**
프로젝트 진행 중, 사용자가 특정 필드에 공백 (예: " ")만 입력했을 경우, Joi에서 이를 유효한 입력으로 처리하는 문제가 발생함. 이로 인해, 사용자가 공백만을 제공하는 경우에도 요청이 성공적으로 처리되어, 예상치 못한 데이터가 데이터베이스에 저장되는 문제가 있었음.

**`해결`**
수정한 스키마를 적용한 후, 사용자가 공백만 제공하는 경우에도 Joi가 이를 유효하지 않은 값으로 처리함. 따라서, 사용자가 공백만 입력하는 경우 요청이 성공적으로 처리되지 않아, 이전에 발생하던 예상치 못한 데이터가 데이터베이스에 저장되는 문제해결 완료.

</details>
</br>
자세한 트러블 슈팅 링크 : https://hungry-mascara-804.notion.site/Technical-Specification-9ab41096af574270985a6f16705e6726

## 👨‍👩‍👧 구성원

| 역할     | 이름   | 분담                                     | 깃허브                           |
| -------- | ------ | ---------------------------------------- | -------------------------------- |
| FE(리더) | 김민승 | UI / UX , 상태 관리 , 서버 통신 작업     | https://github.com/helloworld442 |
| BE       | 윤문열 | CI/CD 구축, HTTPS 구축, s3 이미지 업로드 | https://github.com/munyeol-Yoon  |
| BE       | 정소채 | 회원가입, 로그인, 게시판 CRUD            | https://github.com/GabrielaJeong |

|
